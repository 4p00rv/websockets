---
layout: page
title:  "Websockets"
permalink: websockets/
---

<p>The binary.com websockets service is at</p>

<pre>wss://www.binary.com/websockets/v2</pre>

<p>Open a connection to Binary.com WebSocket service:</p>

<pre data-language="javascript">var ws = new WebSocket('wss://www.binary.com/websockets/v2');</pre>

<p>You can now send data down the websocket using any of the messages described in this Reference.</p>

<p>Depending on the call, one or many messages will be sent back to you.</p>

<p>All the examples in this Reference assume that a websocket object named 'ws' has already been opened as shown above.</p>

Note: to receive responses where English text has been translated to another language, append the language code to the connection URL as follows:

<pre data-language="javascript">var ws = new WebSocket('wss://www.binary.com/websockets/v2?l=RU');</pre>

<h2>Sending and Receiving Messages</h2>

<p>All movement of data in both directions is done with structured JSON-encoded data. All field name identifiers, and most field values, will be double-quoted in the encoded data.  You can avoid the tedious problem of constructing your own JSON strings by invoking the built-in JSON.stringify method on an in-line Javascript object.</p>

<p>The same applies to receiving messages. Each message is a serialized JSON-encoded string, you need to parse it using JSON.parse().</p>

<p>All of our examples use this technique.</p>

<p>Combining some of the examples, here is a JavaScript snippet that opens a websocket, and requests a stream of updates for the symbol "R_100".  On receipt of each message, it outputs a message to the console.</p>

<ul role=segmented>
    <li><a>JavaScript</a></li>
    <li><a>Java</a></li>
    <li><a>C#</a></li>
    <li><a>CoffeeScript</a></li>
    <li><a>Go</a></li>
    <li><a>Ruby</a></li>
    <li><a>PHP</a></li>
    <li><a>Python</a></li>
    <li><a>Swift</a></li>
    <li><a>Perl</a></li>
</ul>

<pre data-language="javascript">var ws = new WebSocket(&#39;wss://www.binary.com/websockets/v2&#39;);

ws.onopen = function(evt) {
    ws.send(JSON.stringify({ticks:&#39;R_100&#39;}));
};

ws.onmessage = function(msg) {
   var data = JSON.parse(msg.data);
   console.log(&#39;ticks update: %o&#39;, data);
};
</pre>

<pre data-language="csharp">class Program
{
    static async Task SendTicksRequest()
    {
        var ws = new ClientWebSocket();
        var uri = new Uri("wss://www.binary.com/websockets/v2");

        await ws.ConnectAsync(uri, CancellationToken.None);

        var reqAsBytes = Encoding.UTF8.GetBytes("{\"ticks\":\"R_100\"}");
        var ticksRequest = new ArraySegment&lt;byte>(reqAsBytes);

        await ws.SendAsync(ticksRequest, WebSocketMessageType.Text, true, CancellationToken.None);

        var buffer = new ArraySegment&lt;byte>(new byte[1024]);
        var result = await ws.ReceiveAsync(buffer, CancellationToken.None);

        string response = Encoding.UTF8.GetString(buffer.Array, 0, result.Count);
        Console.WriteLine(response);
    }

    static void Main(string[] args)
    {
        SendTicksRequest();
        Console.ReadLine();
    }
}
</pre>

<pre data-language="go">package main

import (
	"fmt"
	"regexp"
	"strconv"
	"time"

	"golang.org/x/net/websocket"
)

type Tick struct {
	epoch int64
	quote float64
}

var ticks []Tick

func print_ticks(msg string) {
	epoch, _ := strconv.ParseInt(regexp.MustCompile("\"epoch\":(\\d+)").FindAllStringSubmatch(msg, 1)[0][1], 10, 64)
	quote, _ := strconv.ParseFloat(regexp.MustCompile("\"quote\":\"(\\d+\\.?\\d*)").FindAllStringSubmatch(msg, 1)[0][1], 64)
	fmt.Printf("Current value is: %f\n", quote)

	ticks = append(ticks, Tick{
		epoch: epoch,
		quote: quote,
	})
	if ticks[0].epoch <= time.Now().Unix()-60 {
		fmt.Printf("One minute old value is: %f\n", ticks[0].quote)
		ticks = ticks[1:]
	}
}

func main() {
	ws, _ := websocket.Dial("wss://ws.binary.com/websockets/v2", "", "http://localhost/")
	ws.Write([]byte("{\"ticks\": \"R_50\"}"))

	var msg = make([]byte, 512)
	for {
		ws.Read(msg)
		print_ticks(string(msg))
	}
}
</pre>
